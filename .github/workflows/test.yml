name: test

on:
  pull_request:
    branches:
      - main

jobs:
  analyse-services:
    uses: ./.github/workflows/analyse-services.yml
    with:
      base_sha: ${{ github.event.pull_request.base.sha }}

  service1:
    name: service1
    needs: analyse-services
    if: "${{ needs.analyse-services.outputs.service1 == 'true' }}"
    runs-on: ubuntu-latest
    steps:
      - name: run step
        run: echo "testing service1"

  service2:
    name: service2
    needs: analyse-services
    if: "${{ needs.analyse-services.outputs.service2 == 'true' }}"
    runs-on: ubuntu-latest
    steps:
      - name: run step
        run: echo "testing service2"